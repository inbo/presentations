---
title: "Supporting scientific research at INBO"
author: "D. Brosens, P. Desmet, D. Du Seuil, I. Jansen, E. Lommelen, J. Loos, T. Milotic, T. Onkelinx, P. Quataert, F. Piesschaert, H. Van Calster, T. Van Daele, F. Vanderhaeghe, G. Van Spaendonck, S. Van Hoey, P. Verschelde, T. Westra, C. Wils"
date: "April 28, 2017"
output:
  INBOmd::inbo_slides:
    event_website: http://www.flames-statistics.eu/events/flames-annual-meeting-2017
    location: FLAMES Annual Meeting 2017, KU Leuven
    institute: Research Institute for Nature and Forest (INBO)
    theme: inbo
    cover: "Image00012.png"
    cover_horizontal: FALSE
    cover_hoffset: "-30mm"
    lang: english
    toc: FALSE
    fontsize: 12pt
    slide_level: 3
  beamer_presentation: default
---

```{r include = FALSE}
library(knitr)
opts_chunk$set(
  echo = FALSE,
  cache = TRUE,
  autodep = TRUE
)
library(lme4)
library(dplyr)
library(ggplot2)
library(INBOtheme)
theme_set(theme_inbo(6))
update_geom_defaults("point", list(size = 0.5))
update_geom_defaults("line", list(size = 0.2))
```

```{r}
staff <- 262
admin <- 22
management <- 9
wo <- c(BMK = 8, Data = 8, ICT = 6, Lab = 10, Bib = 8)
science <- staff - admin - sum(wo) - management
```

# Who are we?

### Instituut voor Natuur- en Bosonderzoek (INBO)

> - Research Institute for Nature and Forest (INBO)
> - Flemish government
> - Research and knowledge center
> - Open data institute (since 2015)
> - Topics: nature conservation, forestry, hunting, nature and society, ecosystem services, management
> - Target audience: **policy makers** and stakeholders
> - Provides data for **international reporting** and **biodiversity research**
> - Member of international research networks: LTER, LifeWatch, ALTER-net, GBIF, ...

### 14 teams with scientific staff (`r science` members)

![](KLEURORGANIGRAM_1.png)

### 5 teams in support of scientific staff (`r sum(wo)` members)

![](KLEURORGANIGRAM_2.png)

### 3 administrative teams (`r admin` members)

![](KLEURORGANIGRAM_3.png)

### 1 management team (`r management` members)

![](KLEURORGANIGRAM_def.png)

# Biometry, Methodology & Quality assurance

## Statistical support

### Provide tools to improve reproducible statistical analysis

> - R
> - Scripted analysis
> - Version control
> - Dynamic documents
> - Corporate identity styles for graphics and dynamic documents

### Improve statistical skills of scientific staff

![](20150628_0386.jpg)\ 

## Methodological support

###

#### Sir Ronald Aylmer Fisher

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.

### Partner during the entire life cycle of research

> - Refine hypotheses
> - Experimental design
> - Statistical analysis
> - Report results

### Acquisition, development and maintainance of methodologies

> - Concept for setting up long term monitoring
> - Field protocols
> - Novel statistical techniques
> - Automation of recurring analyses
> - Traceability of analyses
> - Recommended suite of software and tools  

## Statistical expertise

###

#### George E. P. Box

All models are wrong, but some are useful.

### Data validation through statistical modelling

```{r tree}
dataset <- read.csv("tree.csv") %>%
  mutate(lc130 = log(c130 / 100))
model <- lmer(
  height ~ poly(lc130, 2) + (poly(lc130, 2) | location),
  data = dataset
)
dataset <- dataset %>%
  mutate(
    fit = fitted(model),
    residual = residuals(model),
    rank = n() - min_rank(abs(residual))
  )
max_rank <- 27
relevant <- dataset %>%
  filter(rank <= max_rank) %>%
  distinct(location) 
dataset %>%
  semi_join(relevant, by = "location") %>%
  mutate(
    anomaly = rank <= max_rank
  ) %>%
  arrange(desc(rank)) %>%
  ggplot(aes(x = c130, y = height)) +
  geom_jitter(
    aes(colour = anomaly), 
    position = position_jitter(width = 5, height = 0)
  ) +
  geom_line(aes(y = fit)) +
  facet_wrap(~location) +
  xlab("Circumference at 130 cm (cm)") +
  ylab("Tree height (m)") +
  scale_colour_manual(
    "Anomaly", 
    values = c("FALSE" = inbo.steun.geelgroen, "TRUE" = inbo.hoofd)
  )
```

### Distance based estimates of vegetation cover

![](vegetation.jpg)\ 

# Open data & open science

###

![Human species monitoring](slide5.jpg)\ 

###

![Machine species monitoring](oo_73828.jpg)\ 

###

![Abiotic monitoring](BRGP036A_2.jpg)\ 

###

![Lab analysis](slide7.jpg)\ 

## Support scientific staff in data life cycle

### Build and maintain data infrastructure

- Manage major data systems
- Setup data warehouses for uniform data access
- Setup GIS services
- Design data models for new systems
- Coordinate development of new data collection tools

### Provide research software

- Data processing tools
- GIS tools
- Reporting tools

### Example: WUG

![WUG online](wug_online.png)\ 

### Example: WUG

![WUG code on GitHub](wug_github.png)\ 

### Provide support

- Documentation
- Tutorials
- Training
- Ad hoc support

## Open data

### INBO is an open data institute

![Open data policy](open_data_policy.png)\ 

### 

But what does that mean and how did we get there?

#### The Open Definition

Open data and content can be **freely used, modified, and shared** by **anyone** for **any purpose**.

### Considered open if following requirements are met

> 1. With open license or status
> 2. Accessible
> 3. Machine readable
> 4. In open format

### Why open data for research?

> - Increase discoverability
> - Increase potential use
> - Increase collaborations
> - Transparent science

### Move towards open data

> - EC: Directive on the re-use of public sector information (2003/98/EG & 2013/37/EU)
> - Flemish government: open data should become the norm for the Flemish government (_2011 conceptnota open data_)
> - Funding agencies: e.g. Horizon 2020
> - Research journals: deposit data in an open respository

### 2009

Strategic goal to manage and disclose (biodiversity) data

### 2011: First dataset published on GBIF

![http://www.gbif.org/dataset/271c444f-f8d8-4986-b748-e7367755c0c1](gbif_florabank.png)\ 

### Global Biodiversity Information Facility (GBIF)

![http://www.gbif.org](gbif_homepage.png)\ 

### Data publication process

- Format data to international Darwin Core standard
- Document data with metadata (also standardized)
- Publish dataset online
- Register dataset with GBIF
- (Re)publish versioned updates or corrections

### 2012: First data paper

![https://doi.org/10.3897/phytokeys.12.2849](data_paper_florabank.png)\ 

### 2012: Start of the LifeWatch project

![Gull tracking data in breeding areas](lifewatch_gulls_map.png)\ 

### 2013: Choose a license

![Creative Commons zero waiver](cc0.png)

### 2013: GBIF license consultation

![GBIF license consultation](gbif_license_consultation.png)\ 

### 2014: Bouchout declaration

![Bouchout declaration](bouchout_declaration.png)\ 

### 2014: Biological Valuation Map (BVM) as open data

![http://www.geopunt.be/catalogus/datasetfolder/4/48b805e2-3aa1-4d34-b49b-1802e85c4e0c/1acb23e7-09b0-4d92-a0a1-61e4c9ece79b](geopunt_bwk_2014.png)\ 

### 2015: INBO open data policy

![Open data policy](open_data_policy.png)\ 

### Guidelines of the open data policy

1. All scientific data for which the (EV) INBO is (co-)owner are covered by this policy and can be published as open data, excluding legal exceptions.
2. Data are eligible for publication at the earliest 12 months after collecting.
3. Raw data will be published.
4. Result data associated with a scientific article, report, or advice will be released with the publication.
5. Data are published as open data, as defined by the Open Definition, under the Creative Commons Zero waiver.
6. Published datasets reference the INBO norms for data use.
7. Published data are sufficiently documented with metadata.
8. All upcoming research projects require a data management plan (DMP).
9. Researchers apply the open data policy.
10. The INBO Information & Data Center supports researchers in the application of the open data policy.

### INBO on GBIF

![http://www.gbif.org/publisher/1cd669d0-80ea-11de-a9d0-f1765f95f18b](gbif_inbo.png)\ 

### Published data

```r
published_years = c(2011, 2012, 2013, 2014, 2015, 2016)
published_datasets = c(2, 6, 13, 17, 20, 27)
published_occurrences = c(3325224, 3478955, 4009432, 5191428, 7682739, 10203633)
```

*Bar chart with years on x axis, datasets on y1, occurrences on y2*

### Use of data

```r
downloaded_years = c(2013, 2014, 2015, 2016)
downloaded_downloads = c(2091, 11206, 15382, 17974)
downloaded_occurrences = c(504549089, 1603418177, 2764760091, 4178367077)
```

*Bar chart with years on x axis, downloads on y1, occurrences on y2*

### Flemish open data portal

![http://opendata.vlaanderen.be/organization/inbo](vodp_inbo.png)\ 

### Open documentation on GitHub

![Data publication repository](github_bird_tracking.png)\ 

### Challenges

- International platforms/standards for abiotic data
- Publish data associated with scientific publications and reports
- Automate workflows
- Think about data publication at the start of the project

# Towards supporting policy based on open science

### Rome wasn't built in a day

> - Gradual change is key for success
> - Focus on early adopters and early majority
> - Stimulation and support is vital
> - New procedures should lower the burden in the long run
> - Allow for a long transition period before enforcing change

## Designing and evaluating long term monitoring

###

#### John Tukey

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.

### 5 stages of preparing long term monitoring

```{r guidebook}
theme_set(theme_inbo(6, transparent = TRUE))
z <- 0.6
texts <- data.frame(
  phase = c(
"vague
information
requirements", 
"Phase I
supply and demand", 
"Phase II
design
data collection", 
"Phase III
design
data management
data analysis", 
"Phase IV
design
reporting
communication", 
"Phase V
implementation"
    ),
  x = c(-1.5, -z, 0,  z,  0, 1.5),
  y = c(   0,  0, z,  0, -z, 0)
)
shapes <- bind_rows(
  expand.grid(
    phase = 1:4,
    x = 0,
    y = 0
  ),
  expand.grid(
    phase = 1:4,
    angle = seq(-0.5, 0.5, length = 41) * pi / 3 + pi
  ) %>%
  mutate(
    angle = angle - (phase - 1) * pi / 2,
    x = cos(angle),
    y = sin(angle)
  ),
  expand.grid(
    phase = 1:4,
    x = 0,
    y = 0
  ),
  data.frame(
    phase = 0,
    x = c(-1.2, -1.2, -1.8, -1.8, -1.2),
    y = c(-0.3, 0.3, 0.3, -0.3, -0.3)
  ),
  data.frame(
    phase = 5,
    x = c(1.2, 1.2, 1.8, 1.8, 1.2),
    y = c(-0.3, 0.3, 0.3, -0.3, -0.3)
  )
)
rad <- 0.8
arrows <- data.frame(
  phase = 1:4
) %>%
  mutate(
    start = 0.5 * pi / 3 + (phase - 1) * pi / 2,
    end = -0.5 * pi / 3 + phase * pi / 2,
    x = cos(start) * rad,
    y = sin(start) * rad,
    xend = cos(end) * rad,
    yend = sin(end) * rad
  )
triple_arrows <- expand.grid(
  place = c(-1, 1),
  extra = c(-1, 0, 1)
) %>%
  mutate(
    x = pmin(place, place * 1.2),
    xend = pmax(place, place * 1.2),
    y = extra * 0.1,
    yend = extra * 0.1
  )
ggplot(shapes, aes(x = x, y = y)) +
  geom_path(aes(group = phase)) +
  geom_segment(
    data = triple_arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(length = unit(2, "mm"), type = "closed")
  ) +
  geom_segment(
    data = arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(ends = "both", length = unit(2, "mm"))
  ) +
  geom_text(data = texts, aes(label = phase), size = 2) +
  coord_fixed() + 
  theme(
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.background = element_blank(),
    panel.grid = element_blank()
  )
```

### Focus on the relevant questions

```{r guidebook0}
shapes %>%
  mutate(background = phase == 0) %>%
  ggplot(aes(x = x, y = y)) +
  geom_polygon(aes(group = phase, fill = background), show.legend = FALSE) +
  geom_segment(
    data = triple_arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(length = unit(2, "mm"), type = "closed")
  ) +
  geom_segment(
    data = arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(ends = "both", length = unit(2, "mm"))
  ) +
  geom_text(data = texts, aes(label = phase), size = 2) +
  coord_fixed() + 
  scale_fill_manual(values = c("TRUE" = inbo.steun.geelgroen, "FALSE" = NA)) +
  theme(
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.background = element_blank(),
    panel.grid = element_blank()
  )
```

### Prioritise the questions

```{r guidebook1}
shapes %>%
  mutate(background = phase == 1) %>%
  ggplot(aes(x = x, y = y)) +
  geom_polygon(aes(group = phase, fill = background), show.legend = FALSE) +
  geom_segment(
    data = triple_arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(length = unit(2, "mm"), type = "closed")
  ) +
  geom_segment(
    data = arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(ends = "both", length = unit(2, "mm"))
  ) +
  geom_text(data = texts, aes(label = phase), size = 2) +
  coord_fixed() + 
  scale_fill_manual(values = c("TRUE" = inbo.steun.geelgroen, "FALSE" = NA)) +
  theme(
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.background = element_blank(),
    panel.grid = element_blank()
  )
```

### Scenarios based on power and cost 

```{r guidebook2}
shapes %>%
  mutate(background = phase == 2) %>%
  ggplot(aes(x = x, y = y)) +
  geom_polygon(aes(group = phase, fill = background), show.legend = FALSE) +
  geom_segment(
    data = triple_arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(length = unit(2, "mm"), type = "closed")
  ) +
  geom_segment(
    data = arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(ends = "both", length = unit(2, "mm"))
  ) +
  geom_text(data = texts, aes(label = phase), size = 2) +
  coord_fixed() + 
  scale_fill_manual(values = c("TRUE" = inbo.steun.geelgroen, "FALSE" = NA)) +
  theme(
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.background = element_blank(),
    panel.grid = element_blank()
  )
```

### From raw data to final results \vphantom{y}

```{r guidebook3}
shapes %>%
  mutate(background = phase == 3) %>%
  ggplot(aes(x = x, y = y)) +
  geom_polygon(aes(group = phase, fill = background), show.legend = FALSE) +
  geom_segment(
    data = triple_arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(length = unit(2, "mm"), type = "closed")
  ) +
  geom_segment(
    data = arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(ends = "both", length = unit(2, "mm"))
  ) +
  geom_text(data = texts, aes(label = phase), size = 2) +
  coord_fixed() + 
  scale_fill_manual(values = c("TRUE" = inbo.steun.geelgroen, "FALSE" = NA)) +
  theme(
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.background = element_blank(),
    panel.grid = element_blank()
  )
```

### What to communicate \vphantom{y}

```{r guidebook4}
shapes %>%
  mutate(background = phase == 4) %>%
  ggplot(aes(x = x, y = y)) +
  geom_polygon(aes(group = phase, fill = background), show.legend = FALSE) +
  geom_segment(
    data = triple_arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(length = unit(2, "mm"), type = "closed")
  ) +
  geom_segment(
    data = arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(ends = "both", length = unit(2, "mm"))
  ) +
  geom_text(data = texts, aes(label = phase), size = 2) +
  coord_fixed() + 
  scale_fill_manual(values = c("TRUE" = inbo.steun.geelgroen, "FALSE" = NA)) +
  theme(
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.background = element_blank(),
    panel.grid = element_blank()
  )
```

### We're almost ready to rock'n roll \vphantom{y}

```{r guidebook5}
shapes %>%
  mutate(background = phase == 5) %>%
  ggplot(aes(x = x, y = y)) +
  geom_polygon(aes(group = phase, fill = background), show.legend = FALSE) +
  geom_segment(
    data = triple_arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(length = unit(2, "mm"), type = "closed")
  ) +
  geom_segment(
    data = arrows, 
    aes(xend = xend, yend = yend), 
    arrow = arrow(ends = "both", length = unit(2, "mm"))
  ) +
  geom_text(data = texts, aes(label = phase), size = 2) +
  coord_fixed() + 
  scale_fill_manual(values = c("TRUE" = inbo.steun.geelgroen, "FALSE" = NA)) +
  theme(
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.background = element_blank(),
    panel.grid = element_blank()
  )
```
